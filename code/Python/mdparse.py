import os.path
import csv

filepath=os.path.join(os.path.dirname(__file__),'../../../T-600-Star data/ru_snorri/sp1.00.sam')

#f=open(filepath,'r')
#reader=csv.reader(f,delimiter='	')

#for r in reader:
#    if not (r[0][0]=='@'):
#        md=r[19][5:len(r[19])]
#        for c in md:

md='20C72^GT11^GT12A14T0C6^CCG5C27C5C15^C0A36C0T49^C30G0C18^CCCT17^TC9^C10C0T142^T50^C9T30^G13C5^C11C3G1T1^T15T0C6A22C26C2^A3^T40T1^T24C9^GG6^T1G9C31^CCT10^G36^A8^G23T0G18^C15C1A27T9C2G0G26^GC10G0C8A0T2^C1^C9T37C2^T1T22^G2C23C24^AA7^G5T15^G0T0G1^C8^ATC61^C3T11C0T11G10^GG17^T13C2C24^T7^C32C3C1^G0C3T0C7^G0C9C1C0G0G0T0T13^A2^C6C1^C1G10^T5^CGCCGT5^G14T16A3T4C1^CC61C28T58^GC30^C24^TC11^A0A18C1^AG0G7^G23^T30C19^AG11C38^C19C28T4C16C1T23A13C14^C1G135^G7G8^GT32^T42A1A2^AG11T3C15^T14^C3C4^A3^T4^G12A12^C54C10^C6^CC21^C11T0C6C1^CT75C4^C5^C2^C36C3C0A0G5^GC11^GT15C1^TC6^C1G5^C0G1C14C3^G13^C14^C1G44T3C14C6^G28^G17C20G1G30^G13^G2C1C7^C8C0T29^G13^C26^C2^G0G0T26C7^T8C1C10T1C10^C8G4C2A1C11^CC3^C17^C14C9C26C2G0C10C8^CCCCC9^C15C67G6'
cig='16S39M2I27M1I5M1I7M1I11M2I4M2D11M2D35M3D18M1I17M1I4M2I16M1D11M1I17M1I60M1D50M4D7M1I10M2D9M1D154M1D37M2I2M1I4M2I7M1D8M1I3M1I29M1D10M1I9M1D4M2I15M1D60M1I2M1I10M3I4M1D3M1D20M3I19M1I3M1D34M2D6M1D29M1I14M3D10M1D36M1D8M1D43M1D17M1I57M1I12M2D17M2I7M1D1M1D41M1I9M1D24M1D10M1I3M1I12M2I4M2I22M2D7M1D21M1D3M1D8M3D12M1I14M1I5M1I21M1I9M1D39M2D17M1D41M1D7M1D38M1D13M1D5M1I25M1D2M1D8M1D12M1D5M6D5M1D13M1I11M1I7M1I7M3I4M2D5M1I24M1I37M3I41M1I42M2D30M1D24M2D10M2I1M1D21M2D8M1D23M1D22M1I8M1I20M2D4M1I6M1I40M1D47M1I49M1I2M1I27M1D85M2I8M1I44M1D16M2D14M1I18M1D42M5I5M2D31M1D6M1I8M1D8M1D3M1D4M1D14M1I11M1D17M2I7M1I27M1I14M1D6M2D21M1D21M2D7M5I11M1I22M1I40M1D5M1D2M1D48M2D6M1I5M2D17M2D6M1D5M2I2M1D21M1D13M1D14M1D45M79I27M1D28M1D71M1D13M1D11M2I1M1D39M1D13M1D26M1D2M1D36M1D21M2I13M1D30M2D3M1D6M1I11M1D75M5D9M1D12M1I3M1I22M1I53M77S'
bs='CGAAGTTACGGTTGTTTAAGATCAAAGACTTTAAGATTTTCACTATTTCTTCTACCTCGCTATCTACTACGAACTTCAAAGAGGAAACCAGGGAGTACGGGAAGGAGCATGCGAAAGGACAAGGAACGACCATTGAAGCGCCACAGGGAGGGGTCTAGGCCTGATGATTGCAGGCAGGCCTTGGGTAACATCCAGCTTCCCCATTGAAGAAGCTGGTGGAGTGAGCGTTCCCTTGACTCCTCCAAGGAAAGGGAGACTCCTCTTCCCGGTCTGCTCAGTAACGGGTGCCTTCCCAGACACTGGCGTTACCGTTGACCAAGGGGCCCTCAAGCGGCCCTTATATGGGCATGACAGAAGGCTCCTTGCCTCTCTATTCACTTCACAATGTCCTTCAGCACTGGACCCTATACCTGCCGGTTATTCCTAGGTTATATTATTAATGCAACAGAGTAATATTAAAAGCTAATGATTAATAATGTTTATAATAATGATGGATAATTGTTCATGATCATCGCTGTATCTAATTTGTATTATGACTATTCTATTCTATTTTCTTTATTATACTGAAACAGTTTGTGCTTCTCTCAGTCTCTCTTGCTCGGCACTCCAGGGTACTCTTCCGCCCACACGGGACGGGCTGGGGTGGCCATTCTTGGGCTTGGGAAAAGGGGCTGGGCCAGGAGCTGAAGGCTCCACTACCTCCGGATGCTGCAGCAGCAGGAATGCTGGTTCCTGTACCCTTCGGGAAGGAGGGTAAGGAGGTGGGAGAACAAGCCCAAGAATCACTACTACAAGAACATCCTTCCTCAGGAGGGCGGAGGCCAGGGCGTCACCTGTCGGGCCTGGGAGGGTGGGGCAGGCTGAGCATCTGCCACCGCTGGACCTGAGGCTCCCTGCATACCCTGACCCTCCATCTCTGCTCACCACAGGGTCTGCGGGCAAGAGGCAGGTGAGGCCCACGAGCTGTGCCCCTGAGAACTGAGCGGCACCTCCTTCCCAGTTGATGTTGCCCCTTGAGTCATCCTGCTCAACGAGGAGGACAGCGGGGCCCAAGCCGACTACATCAGGGGTGGGTGTGTGGGAGGCGGGCTCTGGGCTCCCGATGTCTGGGGGGCCCAGGAAGAACCAGGGTCCCCAAGGGAGGGGTGGGGCGGTAGCCCCAAGGGGTCCTCAGAGAGGCTGATGGGCATTGGGTCCCTCAGCCCCTTGGGTTGAAGCCTGGAGTGAGGAGTGTGTTTGCCACCAGGCTCCTTGCATAATATTTGTAATGTTTGCATATTTGCATAGCATTTTGCATGGACTTGTTTTGTCCCTCTGTTAACAGCAGCAGTTGGGCCTCATTCCTCTCAGACTGACCTGGAGGAGGAGCCAGGCCATGGCAGGCAGGGTGGACATCCCTGTGGCCCTGCCCTGCTGCACCTGCACCTGCACAGCCCGCGGGGCCCGCCCGCCGCAGCTGAAGTGCACCACCATGGGCCTGGCTCAGGCCTGCGGCTCAGGCTCCTGGGGCACCACCACCTCGTCCCGGAGCGAGGATGCTGCGGGATCGGCCGGAAGTCCGCCAGCCGAAGTACCGGGAAGTGCTGGCACCGTGCCGCCGTGGGGGATTCCCCTGCGGGGCAGGGCCTCGCGGGCGCAGGGGTGTACATCGCCTGCAGGGCTGTCTGCAGGGCTGTTCGCTGCAGGCCACGGTGGCTGCTTTCGGGGCCACGGTGCACCAGGGAGAACACGCGTGTCATCGTCATGACCACCAGGGAGATGGAGGGGCCGGGTAGGGGTGCGGTGCCAGTGCTCCAGTGCCCATCCCACCCCGTGCATTCGGCTGCCTGCTGGCCCTTCCCGACCAGGCTACAGGCTGTGGACGCCGTGGGAGTGGGGAGGCCCCACAGAGCCCCGTGGCTGCATCGTACACATTCTGCGTCTCTGCAGGTCGCGGGCGGGGGTGTCAGAGGTGCTGCCAGCAAGGCTGATGCAAAGCGCTCCCCTGGAACAAGTGTTTCCGGGATTGGCCAGAGCTGCCCGGCAGCCAAGAGCTCCGGCTGTGTGCACATGCGCGTTCCCGGCAAGGGCCAGGCCCAGGGCTGGCTTGCGTGCGGGAGTTGCAGGTGTGGCGGCTGGCCAGGTGAGCCTGGCGGCTGTGGAGCGTGCCTGCTGTCGGCCTGCACTGGGAGACCCCACACCTGCCTGCATCCAACCCCAGGCTGCCTTTGGGGGGCTTCCACACCCCTCAACCCAGGAGGTGCATTCCAAGCCTGACAGGGCTCACTGACGGCCACATTCTCAGCCCCTGGGCTGGCGGCCGCCCTCCCACACACCTCTCCAACTGCAGCTTTGGTCTCCGTTGTGGCGCCTTCCAGACGCCCATTCCTGTTCCGGGCAGATTACCCGTGTTCCCCTCCAGCCCTGCCCGTGGTGTGGGGGGTCCTCCTGTGACCCCATGGACCCTCACATTTGGTTTTTCTCCTTATAAAAATAACTGTCCTCACAGCCTGCTTCTGCCTGCCCCCAGCTCCTCTTCTTCCCCAGGCACCTGAGCCACTGGGGCCATCCTGGCGCCTCCCCCATTTCCTCTCCTTCCTCCTCCCTCCTGCTCGCCTTGGCTCCCTGCAGCCCCTCCGCTTGGGCACTCCCGGAAACCCAGTTGTGCTCAGCTCTCCTCCCACCCTGGGGTCACACTCACCGCTTGCCCTGCTTGTGAGGACACAGCGGTACGGCAGCACTTCCAGTAATGGCTGGCTGACTTTAAGTGTCCGGGCCGATCCTGCCGCGTCCTCGGCTTCGGGACGAGGTGAACTGGCCCAGAGCAGCAAGCCGCGGGCCGGGCCCATGGTGGTGCACCCCCAGCTGGGTGGCGGGGCGGCCCACGCGGGCTGTGCAGATGCAGGTGCGGCGGGCGGGGCCACGCGGGCTGTGAAGGTGCAGGTGCGGCGGGGCGGGGCCACGCGGCTGTGCAGATGCAGGTGCGGCGGGGCGGGCCACGCGGGCTGTGAAGGTGCAGGTGCGGCGGGGCAGAGCCACGCGGGACGACGAGGGCGGAGCCATCGGTGGGCGGGGGCCCTCTGCCCCCCTGCCCCCACTTCCGTCAAAGGCCGCCTAGTTTGTCCTCAGTGGGGCATCGGATGACGGGCACCATCATCGTGATTGACATCTCAGGACGTCATCCGCAGGCAGGGCGAGCTGCTCCACCTGGGTCCTCTCGCCCTGCCCCAAGTTATAGCCCCACCCTCCGGACGACTCCCCACCTCCGGACGACCACCCTCAGGGACGACCCCACCCTCAGGACGACCTCACCGCTACTGGCAAGCCCCGCCCCTCATCAGCAGCTCCTGCCCTGCCTGCTGGCACCTTCATCCGTAGCCCTCCCCAAGCGGCGTTTTGTCCGCAGGGCTGGACTGCGGACACCGACGTCCCGAAGACGATCCAGCTGGTTTGGCGGCAGCACTTGGGAATAGGTTAACACCCAAGCAGACGCCGAAGATAGAGCGACAGGCAAGAGCAATACGTAACTGGAACGAAGTATTACCGAT'

num=''
nstr=''
ind=0

for c in cig:
    if c.isdigit(): num+=c
    elif (c=='I' or c=='S'):
        ind+=int(num)
        num=''
    elif (c=='M'):
        nstr+=bs[ind:(ind+int(num))]
        ind+=int(num)
        num=''
    elif (c=='D' or c=='H'): num=''


num=''
ref=''
ind=0
delcounter=0
for c in md:
    if c.isdigit(): num+=c
    elif (c=='^'):delcounter+=1 
    else:
        if (not num==''):
            ref+=nstr[ind:(ind+int(num))]
            ind+=int(num)
            num=''
        ref+=c
        ind+=1

#if (not num==''):
#    ref+=nstr[ind:(ind+int(num))]
#    ind+=int(num)
#    num=''

print(ref+'\n')
#print(nstr+'\n')
print(bs[16:(len(bs)-77)])
